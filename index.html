<html>
<head>
<script type="text/javascript" src="logarithmica_numerus_lite.js"></script>
<script>
function formatDecimal(a) {
a = new Decimal(a);
var e = Math.floor(a.logarithm);
if(e<308) return Math.floor(Math.pow(10,a.logarithm));
else if(e>308&&e<9e15) return Math.pow(10,a.logarithm-e)+"e+"+e;
else if(e>9e15&&3<1e308) return "e"+e;
else return "Infinity";
}

function factorial(a) { // calculates a!
a = new Decimal(a)
if(a.lt(1000)&&(a.floor().sub(a).lt(new Decimal(0.000000000000001))||a.floor().sub(a).gt(new Decimal(0.999999999999999)))) { // is a an integer less than 1000? If so, calculate it exactly.
var result = new Decimal(1);
while(a.gte(1)) {
result = result.mul(a);
a = a.sub(1);
}
return new Decimal(result);
}
else { // if it's a non-integer, or over 1000, use Stirling's approximation. (Warning: Stirling's approximation is not exact. Inaccurate results for low non-integers are possible. Use with care.)
return a.add(1/6).mul(Math.PI*2).pow(0.5).mul(a.div(Math.E).pow(a));
}
}

class BANArray {
constructor(a) {
this.entries = [];
for(var i=0; i<a.length; i++) this.entries.push(a[i]);
}
static solve(array) {
if(array.constructor!=BANArray) array = new BANArray(array);
if(array.entries.length==1||array.entries[1]==1) return formatDecimal(new Decimal(array.entries[0])); // if there's one entry, evaluate it as that. If the second entry is 1, it's the first entry.
if(array.entries.length==2) return formatDecimal(Decimal.pow(array.entries[0],array.entries[1]));
var newArray = new BANArray(array); // variable for the stored array
var newArray2 = new BANArray(array); // second copy of the array
if(array.entries[array.entries.length-1]==1) {
newArray.entries.pop(); // remove trailing 1s
return newArray; // function breaks at this point if this rule was executed
}
for(var i=0; i<newArray.entries.length; i++) {
if(newArray.entries[i].constructor==BANArray) {
newArray.entries[i] = BANArray.solve(newArray.entries[i]);
return newArray; // function finishes at this point
}
}
if(array.entries[2]>1) { // recursion rule
newArray2.entries[1]--;
newArray.entries[1] = newArray2;
newArray.entries[2]--;
}
}
}

class SANArray {
constructor(a) {
this.entries = [];
for(var i=0; i<a.length; i++) this.entries.push(a[i]);
}
static solve(array) {
if(array.constructor!=SANArray) array = new SANArray(array);
if(array.entries.length==1) return formatDecimal(new Decimal(array.entries[0]));
if(array.entries.length==2) return formatDecimal(Decimal.pow(array.entries[0],array.entries[1]));
var newArray = new SANArray(array); // variable for the stored array
for(var i=0; i<array.entries.length; i++) {
if(newArray.entries[i].constructor==SANArray) newarray.entries[i] = SANArray.solve(newArray.entries[i]);
return new Array; // function finishes at this point
}
}
}

class UNANArray {
constructor(a) {
this.entries = [];
for(var i=0; i<a.length; i++) this.entries.push(a[i]);
}
static solve(array) {
if(array.constructor!=UNANArray) array = new UNANArray(array);
if(array.entries.length==1) return formatDecimal(new Decimal(array.entries[0]));
if(array.entries.length==2) return formatDecimal(Decimal.mul(array.entries[0],array.entries[1]));
if(array.entries.length==3&&array.entries[2]==0) return formatDecimal(Decimal.mul(array.entries[0],array.entries[1]));
if(array.entries.length==3&&array.entries[2]==1) return formatDecimal(Decimal.pow(array.entries[0],array.entries[1]));
var newArray = new UNANArray(array); // variable for the stored array
for(var i=0; i<array.entries.length; i++) {
if(newArray.entries[i].constructor==UNANArray) newarray.entries[i] = UNANArray.solve(newArray.entries[i]);
return new Array; // function finishes at this point
}
}
}

class ExEExpression {
constructor(a) {
this.entries = [];
for(var i=0; i<a.length; i++) this.entries.push(a[i]);
}
static solve(array) {
if(array.constructor!=ExEExpression) array = new ExEExpression(array);
if(array.entries.length==1) return formatDecimal(Decimal.pow(10,array.entries[0]));
var newArray = new ExEExpression(array); // variable for the stored array
for(var i=0; i<array.entries.length; i++) {
if(newArray.entries[i].constructor==ExEExpression) newarray.entries[i] = ExEExpression.solve(newArray.entries[i]);
return new Array; // function finishes at this point
}
}
}

class HANArray {
constructor(a) {
this.entries = [];
for(var i=0; i<a.length; i++) this.entries.push(a[i]);
}
static solve(array) {
if(array.constructor!=HANArray) array = new HANArray(array);
if(array.entries.length==1) return formatDecimal(factorial(array.entries[0]));
var newArray = new HANArray(array); // variable for the stored array
for(var i=0; i<array.entries.length; i++) {
if(newArray.entries[i].constructor==HANArray) newarray.entries[i] = HANArray.solve(newArray.entries[i]);
return new Array; // function finishes at this point
}
}
}

</script>
</head>
<body>
Test
</body>
</html>
